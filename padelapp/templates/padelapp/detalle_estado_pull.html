{% extends 'base.html' %}

{% block content %}
<div class="container mt-4">
    <h2 class="mb-4">Estado de la Pull: {{ pull.nombre }}</h2>
    <p><strong>Fecha:</strong> {{ pull.fecha }}</p>
    <p><strong>Hora:</strong> {{ pull.hora }}</p>

    <h3 class="mt-4">Titulares ({{ titulares|length }})</h3>
<ul class="list-group">
    {% for jugador in titulares %}
    <li class="list-group-item">{{ forloop.counter }}. {{ jugador.jugador.username }} - Inscrito: {{ jugador.timestamp|date:"d/m/Y H:i" }}</li>
    {% empty %}
    <li class="list-group-item text-muted">No hay titulares inscritos.</li>
    {% endfor %}
</ul>

<h3 class="mt-4">Reservas ({{ reservas|length }})</h3>
<ul class="list-group">
    {% for jugador in reservas %}
    <li class="list-group-item">{{ forloop.counter }}. {{ jugador.jugador.username }} - Inscrito: {{ jugador.timestamp|date:"d/m/Y H:i" }}</li>
    {% empty %}
    <li class="list-group-item text-muted">No hay reservas inscritos.</li>
    {% endfor %}
</ul>

<h3 class="mt-4">No puedo asistir ({{ no_asisten|length }})</h3>
<ul class="list-group">
    {% for jugador in no_asisten %}
    <li class="list-group-item">{{ forloop.counter }}. {{ jugador.jugador.username }} - Inscrito: {{ jugador.timestamp|date:"d/m/Y H:i" }}</li>
    {% empty %}
    <li class="list-group-item text-muted">Nadie ha dicho que no puede asistir.</li>
    {% endfor %}
</ul>


    <div class="d-flex gap-2 mt-4">
        <a href="{% url 'lista_pulls' %}" class="btn btn-secondary">Volver a la lista</a>
    
        <!-- Bot贸n para abrir modal -->
        <button type="button" class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#inscripcionModal">
            <i class="bi bi-person-check"></i> Inscribirme
        </button>
    </div>
    
        
</div>

<!-- Modal de inscripci贸n -->
<div class="modal fade" id="inscripcionModal" tabindex="-1" aria-labelledby="inscripcionModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="inscripcionModalLabel">Inscribirme en {{ pull.nombre }}</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Cerrar"></button>
            </div>
            <div class="modal-body">
                <form method="post" action="{% url 'inscribirse_pull' pull.id %}">
                    {% csrf_token %}
                    <label for="tipo">Selecciona tu posici贸n:</label>
                    <select name="tipo" id="tipo" class="form-select" required>
                        <option value="Titular">Titular</option>
                        <option value="Reserva">Reserva</option>
                        <option value="No puedo asistir">No puedo asistir</option>
                    </select>
                    <div class="modal-footer mt-3">
                        <button type="submit" class="btn btn-primary">Confirmar inscripci贸n</button>
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>

{% endblock %}
